1. More order in code. Improve comments.

2. More test cases.
